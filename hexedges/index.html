<!doctype>
<html>
<head>
    <title>Hexagon Edges Game</title>
<style>
    body {
        padding: 0px;
        margin: 0px;
    }
    canvas {
        background: gray;
    }
</style>
</head>
<body>
<script src="https://codeabbey.github.io/js-things/p5.js"></script>
<script>

var pts = [
    [0.01, 1/2],
    [1/3, 0.01],
    [2/3, 0.01],
    [0.99, 1/2],
    [2/3, 0.99],
    [1/3, 0.99],
];

var lines = [];

var ptSize;

var ptStart;

var side = 0;

function setup() {
    createCanvas(windowWidth, windowHeight);
    recalcSizes();
    noLoop();
}

function mousePressed() {
    ptStart = detectPoint(mouseX, mouseY);
    loop();
}

function mouseReleased() {
    noLoop();
    var ptEnd = detectPoint(mouseX, mouseY);
    if (ptStart >= 0 && ptEnd >= 0 && ptStart != ptEnd) {
        if (ptStart > ptEnd) {
            ptStart += ptEnd; ptEnd = ptStart - ptEnd; ptStart -= ptEnd;
        }
        if (lines.every(ln => ln[0] != ptStart || ln[1] != ptEnd)) {
            lines.push([Math.min(ptStart, ptEnd), Math.max(ptStart, ptEnd), side]);
            side = 1 - side;
        } else {
            alert('Hey, already line here!\nDon\'t you see?');
        }
    }
    ptStart = -1;
    redraw();
}

function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
    recalcSizes();
    redraw();
}

function recalcSizes() {
    ptSize = Math.round(Math.min(windowWidth, windowHeight) / 10);
    pts.forEach(p => {
        p[2] = Math.round(windowWidth * p[0]);
        p[3] = Math.round(windowHeight * p[1]);
    });
}

function draw() {
    clear();
    strokeWeight(5);
    lines.forEach(ln => {
        stroke(ln[2] == 0 ? '#f00' : '#44f');
        line(pts[ln[0]][2], pts[ln[0]][3], pts[ln[1]][2], pts[ln[1]][3]);
    });
    strokeWeight(1);
    stroke('#000');
    pts.forEach(p => {
        circle(p[2], p[3], ptSize);
    });
    if (ptStart > -1) {
        stroke(side == 0 ? '#f00' : '#44f');
        line(pts[ptStart][2], pts[ptStart][3], mouseX, mouseY);
    }
}

function detectPoint(x, y) {
    return pts.findIndex(p => {
        return Math.hypot(p[2] - x, p[3] - y) < ptSize / 2;
    });
}

</script>
</body>
</html>